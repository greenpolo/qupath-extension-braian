
    public void autoDetectAtlas() {
        if (qupath.lib.gui.QuPathGUI.getInstance() != null) {
            var viewer = qupath.lib.gui.QuPathGUI.getInstance().getViewer();
            if (viewer != null && viewer.getImageData() != null) {
                var root = viewer.getImageData().getHierarchy().getRootObject();
                if (root != null && root.getPathClass() != null) {
                    String detected = root.getPathClass().getName();
                    if (config.getAtlasName() == null || config.getAtlasName().equals("allen_mouse_10um_java")) {
                        config.setAtlasName(detected);
                        notifyConfigChanged();
                    }
                }
            }
        }
    }
